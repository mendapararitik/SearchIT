<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <!-- Import Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"
    ></script>
    <title>Semantic Search Tool</title>
    <link rel="stylesheet" type="text/css" href="style.css">
  </head>
  <body>
    <!-- front end-->
    <header class="header" style="background-color : #3F2305;">
      <a href="#" class="logo"><i class="fa fa-search">SearchIT</i></a>
      <nav class="navbar"> 
          <a href="#home">HOME</a>
          <a href="#about">ABOUT</a>
          <a href="#contact">CONTACT</a>
      </nav>
  </header>
      <!-- front end-->

    <div class="container-fluid" style="margin-top: 150px;">
      <main>
        <a name="home"></a>
        <h1 class="text-center" style="font-size: 30px;
        font-weight: bold;  
        color: #3F2305;
        text-align: center;
        margin-bottom: 16px;">Semantic Videos Search Tool</h1>
      </main>

      <div>
        <div style="margin-left: 33%;">
        <label for="queryText" class="fs-3">Question:</label><br />
        <div style="    display: flex;">
        <input
          type="text"
          id="queryText"
          name="queryText"
          class="form-control input-lg mt-1" style="margin-right: 10px;"
        />
        <button
          onclick="sendData()"
          id="submitButton"
          class="btn btn-secondary mt-2"
        >
          Submit
        </button>
      </div>
      </div>

       

      <!-- <div id="votingDiv" style="display:none">
      <button id="goodVote" onclick="sendVote('good')" class="btn btn-primary mt-1">üëç</button>
      <button id="badVote" onclick="sendVote('bad')" class="btn btn-danger mt-1">üëé</button>
    </div> -->

      <div id="loadingDiv" class="fs-4 mt-2" style="display: none">
        Loading...
      </div>

      <br />
      <div id="responseDiv" style=" "></div>
    </div>
    <a name="about" ><br>
      <div id="about-content">

      <p style="font-size: 24px;
      margin-bottom: 20px;padding-top: 25px;">ABOUT</p>        </br></a>

      <p >
          Welcome to our Semantic Search Tool!
          <br/>

  Our Semantic Search Tool utilizes advanced natural language processing techniques to provide you with highly accurate and relevant search results. Unlike traditional keyword-based search engines, our tool understands the meaning behind your queries and retrieves information based on its semantic context.
  <br/>

  How does it work?
  <br/>

  When you enter a query into our Semantic Search Tool, it analyzes the entire search phrase, taking into account the relationships between words and their contextual meaning. By understanding the intent behind your query, our tool is able to deliver results that match your requirements more effectively.
  <br/>

  Key Features:
  <br/>

  1. Precise Results: Our Semantic Search Tool goes beyond simple keyword matching. It considers the semantics of your query, including synonyms, related concepts, and context, to provide you with more accurate and meaningful results.
  <br/>

  2. Conceptual Understanding: With our tool, you can express your query in natural language. It understands the meaning and relationships between words, allowing you to phrase your search in a way that feels natural to you.
  <br/>

  3. Contextual Relevance: Our tool takes into account the context of your search to deliver results that align with your specific needs. It considers the broader context of the information you're seeking, resulting in more relevant and comprehensive search results.
  <br/>

  4. Efficient and Fast: Despite the complexity of its underlying algorithms, our Semantic Search Tool is designed for efficiency and speed. It quickly processes your queries and retrieves results in a matter of seconds, ensuring a seamless search experience.
  <br/>

  5. User-friendly Interface: Our tool features a clean and intuitive interface, making it easy to use for both casual and advanced users. Simply enter your query, and let our tool handle the rest.
  <br/>
  <br/>
  <br/>

  Whether you're conducting research, exploring a new topic, or seeking specific information, our Semantic Search Tool is your go-to resource. Experience the power of semantic search and unlock a new level of precision and relevance in your search results.
  <br/>
  <br/>

  Start using our Semantic Search Tool today and discover the difference it can make in your information retrieval process.
      </p>
      <a name="contact"><br>
    <div id="contact-details">
      <p style="font-size: 24px;
      margin-bottom: 20px;">CONTACT DETAILS</p>
      </br></a>

      
      <div class="contact">
        <h3>Ritik Mendapara</h3>
        <p><strong>Email:</strong>200303105034@paruluniversity.ac.in</p>
        <p><strong>Enrollment No.:</strong>200303105034 </p>
      </div>
    
      <div class="contact">
        <h3>Het Kasundra</h3>
        <p><strong>Email:</strong>200303105027</p>
        <p><strong>Enrollment No.:</strong>200303105027@paruluniversity.ac.in</p>
      </div>
      <div class="contact">
          <h3>Yash Patel</h3>
          <p><strong>Email:</strong>200303105055@paruluniversity.ac.in</p>
          <p><strong>Enrollment No.:</strong>200303105055 </p>
        </div>
        <div class="contact">
          <h3>Dishit Jayswal</h3>
          <p><strong>Email:</strong>200303105022@paruluniversity.ac.in</p>
          <p><strong>Enrollment No.:</strong>200303105022 </p>
        </div>  
    
    </div>
    <script>
      // Define all elements
      // var votingDiv = document.getElementById("votingDiv")
      var loadingDiv = document.getElementById("loadingDiv");

      // Get the input field
      var input = document.getElementById("queryText");

      // Execute a function when the user presses a key on the keyboard
      input.addEventListener("keypress", function (event) {
        // If the user presses the "Enter" key on the keyboard
        if (event.key === "Enter") {
          // Cancel the default action, if needed
          event.preventDefault();
          // Trigger the button element with a click
          submitButton.click();
        }
      });

      function sendVote(responseName, vote) {
        // Get data from session storage
        let result = sessionStorage.getItem("result");

        result = JSON.parse(result);

        // console.log(responseName)

        // Update Google Sheets
        updateGoogleSheets(result, vote, responseName);

        // Reveal voting buttons
        // votingDiv.style.display = "none"
      }

      function populateContent(result) {
        result = JSON.parse(result);

        var responseBox = document.getElementById("responseDiv");

        // Clear innerHTML of responseBox
        responseBox.innerHTML = "";

        var innerHTML = "";

        // Get all responses and populate HTML
        for (const key in result) {
          console.log(`${key}: ${result[key]}`);

          resultArray = result[key];

          var title = resultArray[0];
          var link = resultArray[1];
          var context = resultArray[2];
          var score = resultArray[3];

          innerHTML += `<h2><a href=${link} target="_blank">${title}</a></h2><button id="goodVote" onclick="sendVote('${key}','good')" class="btn btn-primary m-1">üëç</button><button id="badVote" onclick="sendVote('${key}','bad')" class="btn btn-danger m-1">üëé</button>
                      <p><b>Context:</b> ${context}</p>
                      <p><b>Score:</b> ${score}</p>
                      <br>
                      `;
        }

        // Make loading div disappear
        loadingDiv.style.display = "none";

        // Repopulate responseBox
        responseBox.innerHTML = innerHTML;

        // Store result in session storage
        sessionStorage.setItem("result", JSON.stringify(result));

        // Update Google Sheets
        updateGoogleSheets(result, "none", "none");

        // Reveal voting buttons
        // votingDiv.style.display = "block"
      }

      function updateGoogleSheets(result, vote, choice) {
        let queryString = document.getElementById("queryText").value;

        // Google Sheets API
        let url =
          "https://script.google.com/macros/s/AKfycbwTmL2r1sUl08MLYKcYueKjY8ElyI5kZqWRjaEQqCBI-W4A2R5he-kYrn-96P_PQW3H/exec";

        var myHeaders = new Headers();
        myHeaders.append("Content-Type", "application/json");
        myHeaders.append("Content-Type", "application/x-www-form-urlencoded");

        var raw = JSON.stringify({
          question: queryString,
          response1: result["response 1"],
          response2: result["response 2"],
          response3: result["response 3"],
          response4: result["response 4"],
          response5: result["response 5"],
          vote: vote,
          choice: choice,
        });

        console.log(raw);

        var requestOptions = {
          method: "POST",
          headers: myHeaders,
          mode: "no-cors",
          body: raw,
          redirect: "follow",
        };

        fetch(url, requestOptions)
          .then((response) => response.text())
          // .then(result => responseBox.innerHTML = result)
          .then((result) => console.log(`Sent to Google Sheets\n${result}`))
          .catch((error) => console.log("error", error));
      }

      function sendData() {
        loadingDiv.style.display = "block";

        var responseBox = document.getElementById("responseDiv");
        responseBox.innerHTML = "";

        let url = "http://localhost:8990/query/";

        let queryString = document.getElementById("queryText").value;

        var myHeaders = new Headers();
        myHeaders.append("Content-Type", "application/json");

        var raw = JSON.stringify({
          query_string: queryString,
          num_responses: 5,
        });

        var requestOptions = {
          method: "POST",
          headers: myHeaders,
          body: raw,
          redirect: "follow",
        };

        fetch(url, requestOptions)
          .then((response) => response.text())
          // .then(result => responseBox.innerHTML = result)
          .then((result) => populateContent(result))
          .catch((error) => console.log("error", error));
      }
    </script>
  </body>
</html>
